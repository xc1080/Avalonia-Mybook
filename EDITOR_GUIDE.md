# MyBook 视觉小说编辑器使用指南

## 📖 概述

MyBook 提供了一个可视化的故事编辑器，可以轻松管理数万字的剧本内容。

## 🚀 快速开始

### 方法一：导入现有剧本

1. 打开编辑器（运行 EditorProgram.cs）
2. 在右侧"导入剧本"区域粘贴你的剧本文本
3. 点击"导入为新章节"按钮
4. 编辑器会自动解析文本并创建节点结构

### 方法二：手动创建

1. 点击"+ 新建章节"创建章节
2. 选中章节后，点击"+ 新建节点"添加故事节点
3. 在中间编辑区编辑节点内容
4. 点击"保存"按钮保存更改

## 📝 剧本格式说明

### 基础格式

```
# 第一章：森林觉醒

## [start]
背景: forest_morning.jpg
音乐: peaceful_theme.mp3

你醒来时发现自己身处一片陌生的森林中。
阳光透过树叶洒下，鸟鸣声在耳边回响。

前方有两条截然不同的道路...

→ 走左边阴暗的小路 [left_path]
→ 走右边明亮的大道 [right_path]

---

## [left_path]
背景: dark_forest.jpg
音乐: mysterious.mp3

你选择了左边的小路。
随着深入，周围越来越阴暗...

继续 → [left_continue]

---

## [ending_good]
你找到了幸福的结局。

【结局A：美好生活】
```

### 格式说明

- `# 标题` - 章节标题（只能有一个）
- `## [节点ID]` - 节点标记，ID 可自定义
- `背景: 文件名` - 设置背景图片
- `音乐: 文件名` - 设置背景音乐
- `→ 选项文字 [目标节点]` - 创建选择分支
- `继续 → [下一节点]` - 自动前进到下一节点
- `---` - 节点分隔符

### 简单格式

如果你只有纯文本，也可以直接粘贴：

```
你醒来时发现自己身处森林中。

阳光洒下，鸟鸣声回响。

你看到了两条路...
```

编辑器会自动按段落分割为节点。

## 🎯 数据存储

所有数据保存在 `Stories/story_data.json` 文件中：

```json
{
  "Chapters": [
    {
      "Id": "chapter_001",
      "Title": "第一章",
      "OrderIndex": 0
    }
  ],
  "Nodes": [
    {
      "Id": "start",
      "ChapterId": "chapter_001",
      "Text": "故事开始...",
      "Type": "Narration",
      ...
    }
  ]
}
```

## 💡 使用建议

### 对于数万字剧本：

1. **按章节分割** - 将完整剧本分成多个章节文件
2. **使用有意义的节点 ID** - 如 `chapter1_forest_start`
3. **添加注释** - 在文本中使用 `<!-- 注释 -->` 添加说明
4. **定期备份** - 版本控制你的 `story_data.json`

### 工作流程建议：

```
原始剧本.txt 
  → 按章节拆分 
  → 逐章导入编辑器 
  → 添加选项和分支 
  → 测试游戏流程 
  → 导出最终版本
```

## 🔧 高级功能

### 条件分支（未来版本）

```
→ 使用魔法 [magic_path] {requires: wisdom >= 5}
→ 物理攻击 [fight_path] {requires: strength >= 5}
```

### 变量系统（未来版本）

```
{set courage = courage + 1}
{set met_wizard = true}
```

## 📂 文件结构

```
MyBook/
├── Stories/
│   └── story_data.json      # 所有剧本数据
├── Assets/
│   ├── Images/
│   │   └── Backgrounds/     # 背景图
│   └── Audio/
│       └── BGM/             # 背景音乐
└── Saves/                   # 游戏存档
```

## 🎮 从编辑器到游戏

编辑完成后，游戏运行时会自动从 `Stories/story_data.json` 加载数据。

无需手动导出或转换！

## ⚠️ 注意事项

1. **节点 ID 必须唯一** - 重复 ID 会导致导航错误
2. **目标节点必须存在** - 选项指向的节点必须已创建
3. **定期保存** - 点击"保存"按钮保存节点更改
4. **备份数据** - 重要剧本记得备份 JSON 文件

## 🚀 未来计划

- [ ] SQLite 数据库支持（更好的性能）
- [ ] 可视化节点图编辑器（流程图模式）
- [ ] 批量导入导出
- [ ] 语音和 CG 管理
- [ ] 实时预览功能
- [ ] 多人协作支持

---

**提示**: 这只是第一版编辑器，功能会持续完善！
